BYTE_ENABLED = true
NATIVE_ENABLED = false
USE_OCAMLFIND = true
OCAMLPACKS[] += bitstring bitstring.syntax
OCAMLFINDFLAGS = -syntax camlp4o

public.CamlTargets(mods) =
    private.r[] = $(addsuffixes .cmi .sig, $(mods))
    if $(NATIVE_ENABLED)
        r[] += $(addsuffixes .cmx .o, $(mods))
        export r
    if $(BYTE_ENABLED)
        r[] += $(addsuffixes .cmo, $(mods))
        export r
    return $(r)

public.CamlCleanRecursive() =
    rm -f $(filter-proper-targets $(ls R, .)) *.o

section
	.DEFAULT: $(OCamlProgram inflate, inflate)

section
	OCAMLPACKS[] += oUnit
	OCamlProgram(test, test_inflate inflate)
	$(CamlTargets test test_inflate):

.PHONY: clean

clean:
	CamlCleanRecursive()
